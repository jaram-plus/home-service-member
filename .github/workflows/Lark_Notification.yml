name: Lark Notification

on:
  push:
  pull_request:
    types: [opened, reopened, closed]
  issues:
    types: [opened, reopened, closed]
  issue_comment:
    types: [created]
  pull_request_review_comment:
    types: [created]

jobs:
  notify:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Code
        uses: actions/checkout@v4

      # 1. Push ì•Œë¦¼ (ì—¬ëŸ¬ ì»¤ë°‹ ë‚´ì—­ í‘œì‹œ)
      - name: Lark Push Notification
        if: github.event_name == 'push'
        uses: Nghi-NV/lark-message-action@v1
        with:
          lark-bot-notify-webhook: ${{ secrets.LARK_WEBHOOK }}
          header-color: "blue"
          title: "ğŸ”¨ [${{ github.repository }}:${{ github.ref_name }}] New Push"
          content: |
            **${{ github.actor }}**ë‹˜ì´ **${{ github.event.commits.length || 1 }}ê°œ**ì˜ ì»¤ë°‹ì„ í‘¸ì‹œí–ˆìŠµë‹ˆë‹¤.
            
            ${{ join(github.event.commits.*.message, '
            ') }}
            
            ğŸ”— [ì»¤ë°‹ ë¹„êµí•˜ê¸°](${{ github.event.compare }})  |  ğŸ”— [ì»¤ë°‹ ë³´ê¸°](https://github.com/${{ github.repository }}/commit/${{ github.sha }})

      # 2. PR ì•Œë¦¼ (ìƒíƒœ, ë²ˆí˜¸, ì œëª© í‘œì‹œ)
      - name: Lark PR Notification
        if: github.event_name == 'pull_request'
        uses: Nghi-NV/lark-message-action@v1
        with:
          lark-bot-notify-webhook: ${{ secrets.LARK_WEBHOOK }}
          header-color: "purple"
          title: "ğŸ”€ [PR #${{ github.event.pull_request.number }}] ${{ github.event.pull_request.title }}"
          content: |
            **ìƒíƒœ**: ${{ github.event.pull_request.state }} (${{ github.event.action }})
            **ì‘ì„±ì**: ${{ github.actor }}
            
            ${{ github.event.pull_request.body }}
            
            ğŸ”— [PR ë°”ë¡œê°€ê¸°](${{ github.event.pull_request.html_url }})

      # 3. Issue ì•Œë¦¼
      - name: Lark Issue Notification
        if: github.event_name == 'issues'
        uses: Nghi-NV/lark-message-action@v1
        with:
          lark-bot-notify-webhook: ${{ secrets.LARK_WEBHOOK }}
          header-color: "orange"
          title: "â— [Issue #${{ github.event.issue.number }}] ${{ github.event.issue.title }}"
          content: |
            **ìƒíƒœ**: ${{ github.event.action }}
            **ì‘ì„±ì**: ${{ github.actor }}
            
            ${{ github.event.issue.body }}
            
            ğŸ”— [ì´ìŠˆ ë°”ë¡œê°€ê¸°](${{ github.event.issue.html_url }})

      # 4. ëŒ“ê¸€ ì•Œë¦¼ (Issue & PR)
      - name: Lark Comment Notification
        if: github.event_name == 'issue_comment' || github.event_name == 'pull_request_review_comment'
        uses: Nghi-NV/lark-message-action@v1
        with:
          lark-bot-notify-webhook: ${{ secrets.LARK_WEBHOOK }}
          header-color: "green"
          title: "ğŸ’¬ [Comment] #${{ github.event.issue.number || github.event.pull_request.number }} ìƒˆë¡œìš´ ëŒ“ê¸€"
          content: |
            **ì‘ì„±ì**: ${{ github.actor }}
            **ëŒ€ìƒ**: ${{ github.event.issue.title || github.event.pull_request.title }}
            
            ${{ github.event.comment.body }}
            
            ğŸ”— [ëŒ“ê¸€ ë³´ëŸ¬ê°€ê¸°](${{ github.event.comment.html_url }})
